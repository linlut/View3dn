//FILE: thinsehll4_element.cpp
#include <math.h>
#include <geomath.h>
#include <ztime.h>
#include "thinshell4_element.h"
#include "simu_entity.h"

inline double abs(const int n, const double val)
{
	if (n==1){
		if (val>=0) return 1;
		return -1;
	}
	assert(0);
	return 0;
}

inline double conjugate(const double val)
{
	return val;
}

//void J(x1,y1,z1,x2,y2,z2,x3,y3,z3,x4,y4,z4,k,sintheta0,grd)
//double x1;
//double y1;
//double z1;
//double x2;
//double y2;
//double z2;
//double x3;
//double y3;
//double z3;
//double x4;
//double y4;
//double z4;
//double k;
//double sintheta0;
//double grd[12][12];

static void J(const double x1, const double y1, const double z1,
			  const double x2, const double y2, const double z2,
			  const double x3, const double y3, const double z3,
			  const double x4, const double y4, const double z4,
			  const double k, const double sintheta0,
			  double grd[12][12])
{
  double df[85];
  double dfr0[85];
  double dfr1[85];
  double dfr10[85];
  double dfr2[85];
  double dfr3[85];
  double dfr4[85];
  double dfr5[85];
  double dfr6[85];
  double dfr7[85];
  double dfr8[85];
  double dfr9[85];
  double t1;
  double t10;
  double t1003;
  double t1005;
  double t1006;
  double t1010;
  double t1017;
  double t1018;
  double t102;
  double t103;
  double t104;
  double t1040;
  double t1045;
  double t105;
  double t106;
  double t1064;
  double t1065;
  double t1066;
  double t1067;
  double t1069;
  double t107;
  double t1086;
  double t11;
  double t110;
  double t1106;
  double t1108;
  double t111;
  double t1118;
  double t112;
  double t113;
  double t114;
  double t1148;
  double t115;
  double t1150;
  double t1165;
  double t117;
  double t118;
  double t1197;
  double t1202;
  double t121;
  double t1221;
  double t1222;
  double t1223;
  double t1224;
  double t1227;
  double t123;
  double t124;
  double t1242;
  double t125;
  double t1261;
  double t1263;
  double t1273;
  double t129;
  double t130;
  double t1304;
  double t1306;
  double t131;
  double t1321;
  double t135;
  double t1353;
  double t1357;
  double t137;
  double t1377;
  double t1378;
  double t1379;
  double t1380;
  double t1382;
  double t139;
  double t1398;
  double t14;
  double t140;
  double t1415;
  double t1417;
  double t142;
  double t1421;
  double t1423;
  double t1424;
  double t1428;
  double t1439;
  double t1441;
  double t1442;
  double t1446;
  double t1449;
  double t145;
  double t1455;
  double t1457;
  double t1458;
  double t146;
  double t1462;
  double t148;
  double t1488;
  double t149;
  double t1490;
  double t1491;
  double t1495;
  double t1497;
  double t1499;
  double t15;
  double t151;
  double t1511;
  double t1515;
  double t1517;
  double t1518;
  double t1522;
  double t1530;
  double t1532;
  double t1533;
  double t1537;
  double t154;
  double t155;
  double t1563;
  double t1567;
  double t157;
  double t1587;
  double t1588;
  double t1589;
  double t1590;
  double t1592;
  double t160;
  double t1609;
  double t162;
  double t1627;
  double t1629;
  double t163;
  double t164;
  double t1643;
  double t165;
  double t167;
  double t1673;
  double t1675;
  double t1686;
  double t17;
  double t171;
  double t172;
  double t1720;
  double t1724;
  double t173;
  double t1744;
  double t1745;
  double t1746;
  double t1747;
  double t1750;
  double t1765;
  double t1782;
  double t1784;
  double t1798;
  double t18;
  double t180;
  double t1829;
  double t1831;
  double t1842;
  double t185;
  double t1876;
  double t1877;
  double t1878;
  double t1879;
  double t1880;
  double t1881;
  double t1882;
  double t1883;
  double t1884;
  double t1885;
  double t1886;
  double t1887;
  double t1888;
  double t1889;
  double t189;
  double t1890;
  double t1891;
  double t1892;
  double t1893;
  double t1894;
  double t1895;
  double t1896;
  double t1897;
  double t1898;
  double t1899;
  double t1900;
  double t1901;
  double t1902;
  double t1903;
  double t1904;
  double t1905;
  double t1906;
  double t1907;
  double t1908;
  double t1909;
  double t191;
  double t1910;
  double t1911;
  double t1912;
  double t1913;
  double t1914;
  double t1915;
  double t1916;
  double t1917;
  double t1918;
  double t1919;
  double t1920;
  double t1921;
  double t1922;
  double t1923;
  double t1924;
  double t1925;
  double t1926;
  double t1927;
  double t1928;
  double t1929;
  double t193;
  double t1930;
  double t1931;
  double t1932;
  double t1933;
  double t1934;
  double t1935;
  double t1936;
  double t1937;
  double t1938;
  double t1939;
  double t1940;
  double t1941;
  double t1942;
  double t1943;
  double t1944;
  double t1945;
  double t1946;
  double t1947;
  double t1948;
  double t1949;
  double t1950;
  double t1951;
  double t1952;
  double t1953;
  double t1954;
  double t1955;
  double t1956;
  double t1957;
  double t1958;
  double t1959;
  double t1960;
  double t1961;
  double t1962;
  double t1963;
  double t1964;
  double t1965;
  double t1966;
  double t1967;
  double t1968;
  double t1969;
  double t1970;
  double t1971;
  double t1972;
  double t1973;
  double t1974;
  double t1975;
  double t1976;
  double t1977;
  double t1978;
  double t1979;
  double t1980;
  double t1981;
  double t1982;
  double t1983;
  double t1984;
  double t1985;
  double t1986;
  double t1987;
  double t1988;
  double t1989;
  double t1990;
  double t1991;
  double t1992;
  double t1993;
  double t1994;
  double t1995;
  double t1996;
  double t1997;
  double t1998;
  double t1999;
  double t2;
  double t20;
  double t2000;
  double t2001;
  double t2002;
  double t2003;
  double t2004;
  double t2005;
  double t2006;
  double t2007;
  double t2008;
  double t2009;
  double t201;
  double t2010;
  double t2011;
  double t2012;
  double t2013;
  double t2014;
  double t2015;
  double t2016;
  double t2017;
  double t2018;
  double t2019;
  double t2020;
  double t2021;
  double t2022;
  double t2023;
  double t2024;
  double t2025;
  double t2026;
  double t2027;
  double t2028;
  double t2029;
  double t2030;
  double t2031;
  double t2032;
  double t2033;
  double t2034;
  double t2035;
  double t2036;
  double t2037;
  double t2038;
  double t2039;
  double t204;
  double t2040;
  double t2041;
  double t2042;
  double t2043;
  double t2044;
  double t2045;
  double t2046;
  double t2047;
  double t2048;
  double t2049;
  double t2050;
  double t2051;
  double t2052;
  double t2053;
  double t2054;
  double t2055;
  double t21;
  double t212;
  double t215;
  double t219;
  double t22;
  double t220;
  double t23;
  double t230;
  double t231;
  double t235;
  double t243;
  double t245;
  double t247;
  double t25;
  double t256;
  double t257;
  double t261;
  double t265;
  double t267;
  double t27;
  double t275;
  double t278;
  double t28;
  double t284;
  double t288;
  double t29;
  double t292;
  double t295;
  double t3;
  double t310;
  double t314;
  double t32;
  double t328;
  double t33;
  double t330;
  double t34;
  double t340;
  double t35;
  double t36;
  double t366;
  double t368;
  double t37;
  double t379;
  double t38;
  double t4;
  double t40;
  double t402;
  double t41;
  double t416;
  double t420;
  double t43;
  double t434;
  double t436;
  double t44;
  double t446;
  double t45;
  double t46;
  double t472;
  double t474;
  double t48;
  double t485;
  double t5;
  double t50;
  double t508;
  double t51;
  double t518;
  double t52;
  double t523;
  double t527;
  double t529;
  double t53;
  double t530;
  double t546;
  double t548;
  double t55;
  double t558;
  double t56;
  double t57;
  double t58;
  double t581;
  double t583;
  double t59;
  double t594;
  double t6;
  double t60;
  double t61;
  double t617;
  double t62;
  double t63;
  double t631;
  double t635;
  double t64;
  double t652;
  double t654;
  double t66;
  double t664;
  double t67;
  double t687;
  double t689;
  double t69;
  double t7;
  double t70;
  double t700;
  double t72;
  double t723;
  double t73;
  double t737;
  double t74;
  double t741;
  double t75;
  double t758;
  double t760;
  double t770;
  double t79;
  double t793;
  double t795;
  double t8;
  double t80;
  double t806;
  double t82;
  double t827;
  double t828;
  double t833;
  double t85;
  double t852;
  double t853;
  double t854;
  double t855;
  double t857;
  double t873;
  double t89;
  double t892;
  double t894;
  double t895;
  double t899;
  double t9;
  double t90;
  double t901;
  double t903;
  double t913;
  double t917;
  double t919;
  double t920;
  double t924;
  double t932;
  double t934;
  double t935;
  double t939;
  double t94;
  double t95;
  double t96;
  double t961;
  double t963;
  double t967;
  double t969;
  double t970;
  double t974;
  double t98;
  double t987;
  double t989;
  double t99;
  double t990;
  double t994;
  double t997;
  {
    t1 = -x4+x3;
    t2 = fabs(t1);
    t3 = t2*t2;
    t4 = -y4+y3;
    t5 = fabs(t4);
    t6 = t5*t5;
    t7 = -z4+z3;
    t8 = fabs(t7);
    t9 = t8*t8;
    t10 = t3+t6+t9;
    t11 = sqrt(t10);
    t14 = y3-y1;
    t15 = z4-z1;
    t17 = z3-z1;
    t18 = y4-y1;
    t20 = t14*t15-t17*t18;
    t21 = fabs(t20);
    t22 = t21*t21;
    t23 = x4-x1;
    t25 = x3-x1;
    t27 = -t17*t23+t25*t15;
    t28 = fabs(t27);
    t29 = t28*t28;
    t32 = t25*t18-t14*t23;
    t33 = fabs(t32);
    t34 = t33*t33;
    t35 = t22+t29+t34;
    t36 = sqrt(t35);
    t37 = y4-y2;
    t38 = z3-z2;
    t40 = z4-z2;
    t41 = y3-y2;
    t43 = -t37*t38+t40*t41;
    t44 = fabs(t43);
    t45 = t44*t44;
    t46 = x3-x2;
    t48 = x4-x2;
    t50 = t40*t46-t48*t38;
    t51 = fabs(t50);
    t52 = t51*t51;
    t55 = -t48*t41+t37*t46;
    t56 = fabs(t55);
    t57 = t56*t56;
    t58 = t45+t52+t57;
    t59 = sqrt(t58);
    t53 = t36+t59;
    t61 = 1/t53;
    t60 = t10*t61;
    t62 = k*t11*t60;
    t63 = conjugate(t20);
    t64 = -t43;
    t66 = -t27;
    t67 = conjugate(t66);
    t69 = conjugate(t32);
    t70 = -t55;
    t72 = t63*t64+t67*t50+t69*t70;
    t73 = 1/t36;
    t74 = t72*t73;
    t75 = 1/t59;
    t79 = sqrt(0.5-0.5*t74*t75);
    t80 = t79-sintheta0;
    t82 = 1/t35;
    t89 = 1/t58;
    t95 = k*t10;
    t96 = t61*t80;
    t98 = conjugate(-t23);
    t99 = -t1;
    t102 = conjugate(-t18);
    t103 = -t4;
    t106 = conjugate(-t15);
    t107 = -t7;
    t110 = 1/t11;
    t85 = t98*t99+t102*t103+t106*t107;
    t111 = t85*t110;
    t112 = t20*t82;
    t115 = conjugate(-t48);
    t118 = conjugate(-t37);
    t121 = conjugate(-t40);
    t90 = t115*t99+t118*t103+t121*t107;
    t124 = t90*t110;
    t125 = t64*t89;
    t129 = t66*t82;
    t131 = t50*t89;
    t135 = t32*t82;
    t137 = t70*t89;
    t142 = conjugate(-t25);
    t145 = conjugate(-t14);
    t148 = conjugate(-t17);
    t94 = t142*t99+t145*t103+t148*t107;
    t151 = t94*t110;
    t154 = conjugate(-t46);
    t157 = conjugate(-t41);
    t160 = conjugate(-t38);
    t104 = t154*t99+t157*t103+t160*t107;
    t163 = t104*t110;
    t105 = t62*t80;
    df[55] = t105*t20;
    df[54] = t62*t20*t82;
    df[53] = df[54];
    t113 = 1/t79;
    t114 = df[53]*t113;
    t117 = t69*t73*t75;
    df[52] = -0.25*t114*t117;
    t123 = t70*t73*t75;
    df[51] = -0.25*t114*t123;
    t130 = t50*t73*t75;
    df[50] = -0.25*t114*t130;
    t139 = abs(1.0,t66);
    t140 = (t66<0 ? -1 : 1);
    t146 = -1/t66*t67+2.0*t139/t140;
    df[49] = df[50]*t146;
    t149 = t63*t73*t75;
    df[48] = -0.25*t114*t149;
    t155 = t64*t73*t75;
    df[47] = -0.25*t114*t155;
    df[46] = t80*t20*t82;
    t162 = df[46]*k;
    t164 = t11*t10;
    df[45] = t162*t164;
    t165 = t59*t59;
    t167 = t74/t165;
    t171 = t53*t53;
    t172 = 1/t171;
    t173 = df[45]*t172;
    df[44] = 0.25*t114*t167-t173;
    df[43] = df[44]*t75/2.0;
    df[42] = df[43];
    df[41] = 2.0*df[42]*t56;
    t180 = abs(1.0,t55);
    df[40] = -df[52]+df[41]*t180;
    df[39] = df[42];
    df[38] = 2.0*df[39]*t51;
    t185 = t67*t73*t75;
    t189 = abs(1.0,t50);
    df[37] = -0.25*t114*t185+df[38]*t189;
    t191 = df[40];
    t193 = df[37];
    df[36] = -t191*t41-t193*t38;
    df[35] = t191*t37+t193*t40;
    df[34] = df[39];
    df[33] = 2.0*df[34]*t44;
    t201 = abs(1.0,t43);
    df[32] = -df[48]+df[33]*t201;
    t204 = df[32];
    df[31] = -t191*t48+t204*t40;
    df[30] = t193*t46+t204*t41;
    df[29] = -t193*t48-t204*t37;
    df[28] = t191*t46-t204*t38;
    t212 = t36*t36;
    t215 = t72/t212*t75;
    df[27] = 0.25*t114*t215-t173;
    t219 = t35*t35;
    t220 = 1/t219;
    df[26] = -df[55]*t220+df[27]*t73/2.0;
    df[25] = df[26];
    df[24] = 2.0*df[25]*t33;
    t230 = abs(1.0,t32);
    t231 = (t32<0 ? -1 : 1);
    t235 = -1/t32*t69+2.0*t230/t231;
    df[23] = df[51]*t235+df[24]*t230;
    df[22] = df[25];
    df[21] = 2.0*df[22]*t28;
    t243 = abs(1.0,t27);
    df[20] = -df[49]+df[21]*t243;
    t245 = df[23];
    t247 = df[20];
    df[19] = t245*t18+t247*t15;
    df[18] = -t245*t14-t247*t17;
    df[17] = df[22];
    df[16] = 2.0*df[17]*t21;
    t256 = abs(1.0,t20);
    t257 = (t20<0 ? -1 : 1);
    t261 = -1/t20*t63+2.0*t256/t257;
    t265 = t105*t82;
    df[15] = df[47]*t261+df[16]*t256+t265;
    t267 = df[15];
    df[14] = t245*t25-t267*t17;
    df[13] = -t247*t23-t267*t18;
    df[12] = t247*t25+t267*t14;
    df[11] = -t245*t23+t267*t15;
    df[10] = t162*t60;
    t275 = t11*t61;
    t278 = 1/t11;
    df[9] = t162*t275+df[10]*t278/2.0;
    df[8] = df[9];
    df[7] = 2.0*df[8]*t8;
    t284 = abs(1.0,t7);
    df[6] = df[7]*t284;
    df[5] = df[8];
    df[4] = 2.0*df[5]*t5;
    t288 = abs(1.0,t4);
    df[3] = df[4]*t288;
    df[2] = df[5];
    df[1] = 2.0*df[2]*t2;
    t292 = abs(1.0,t1);
    df[0] = df[1]*t292;
    dfr0[55] = t105*t66;
    dfr0[54] = t62*t66*t82;
    dfr0[53] = dfr0[54];
    t295 = dfr0[53]*t113;
    dfr0[52] = -0.25*t295*t117;
    dfr0[51] = -0.25*t295*t123;
    dfr0[50] = -0.25*t295*t130;
    dfr0[49] = dfr0[50]*t146+t265;
    dfr0[48] = -0.25*t295*t149;
    dfr0[47] = -0.25*t295*t155;
    dfr0[46] = t80*t66*t82;
    t310 = dfr0[46]*k;
    dfr0[45] = t310*t164;
    t314 = dfr0[45]*t172;
    dfr0[44] = 0.25*t295*t167-t314;
    dfr0[43] = dfr0[44]*t75/2.0;
    dfr0[42] = dfr0[43];
    dfr0[41] = 2.0*dfr0[42]*t56;
    dfr0[40] = -dfr0[52]+dfr0[41]*t180;
    dfr0[39] = dfr0[42];
    dfr0[38] = 2.0*dfr0[39]*t51;
    dfr0[37] = -0.25*t295*t185+dfr0[38]*t189;
    t328 = dfr0[40];
    t330 = dfr0[37];
    dfr0[36] = -t328*t41-t330*t38;
    dfr0[35] = t328*t37+t330*t40;
    dfr0[34] = dfr0[39];
    dfr0[33] = 2.0*dfr0[34]*t44;
    dfr0[32] = -dfr0[48]+dfr0[33]*t201;
    t340 = dfr0[32];
    dfr0[31] = -t328*t48+t340*t40;
    dfr0[30] = t330*t46+t340*t41;
    dfr0[29] = -t330*t48-t340*t37;
    dfr0[28] = t328*t46-t340*t38;
    dfr0[27] = 0.25*t295*t215-t314;
    dfr0[26] = -dfr0[55]*t220+dfr0[27]*t73/2.0;
    dfr0[25] = dfr0[26];
    dfr0[24] = 2.0*dfr0[25]*t33;
    dfr0[23] = dfr0[51]*t235+dfr0[24]*t230;
    dfr0[22] = dfr0[25];
    dfr0[21] = 2.0*dfr0[22]*t28;
    dfr0[20] = -dfr0[49]+dfr0[21]*t243;
    t366 = dfr0[23];
    t368 = dfr0[20];
    dfr0[19] = t366*t18+t368*t15;
    dfr0[18] = -t366*t14-t368*t17;
    dfr0[17] = dfr0[22];
    dfr0[16] = 2.0*dfr0[17]*t21;
    dfr0[15] = dfr0[47]*t261+dfr0[16]*t256;
    t379 = dfr0[15];
    dfr0[14] = t366*t25-t379*t17;
    dfr0[13] = -t368*t23-t379*t18;
    dfr0[12] = t368*t25+t379*t14;
    dfr0[11] = -t366*t23+t379*t15;
    dfr0[10] = t310*t60;
    dfr0[9] = t310*t275+dfr0[10]*t278/2.0;
    dfr0[8] = dfr0[9];
    dfr0[7] = 2.0*dfr0[8]*t8;
    dfr0[6] = dfr0[7]*t284;
    dfr0[5] = dfr0[8];
    dfr0[4] = 2.0*dfr0[5]*t5;
    dfr0[3] = dfr0[4]*t288;
    dfr0[2] = dfr0[5];
    dfr0[1] = 2.0*dfr0[2]*t2;
    dfr0[0] = dfr0[1]*t292;
    dfr1[55] = t105*t32;
    dfr1[54] = t62*t32*t82;
    dfr1[53] = dfr1[54];
    t402 = dfr1[53]*t113;
    dfr1[52] = -0.25*t402*t117;
    dfr1[51] = -0.25*t402*t123;
    dfr1[50] = -0.25*t402*t130;
    dfr1[49] = dfr1[50]*t146;
    dfr1[48] = -0.25*t402*t149;
    dfr1[47] = -0.25*t402*t155;
    dfr1[46] = t80*t32*t82;
    t416 = dfr1[46]*k;
    dfr1[45] = t416*t164;
    t420 = dfr1[45]*t172;
    dfr1[44] = 0.25*t402*t167-t420;
    dfr1[43] = dfr1[44]*t75/2.0;
    dfr1[42] = dfr1[43];
    dfr1[41] = 2.0*dfr1[42]*t56;
    dfr1[40] = -dfr1[52]+dfr1[41]*t180;
    dfr1[39] = dfr1[42];
    dfr1[38] = 2.0*dfr1[39]*t51;
    dfr1[37] = -0.25*t402*t185+dfr1[38]*t189;
    t434 = dfr1[40];
    t436 = dfr1[37];
    dfr1[36] = -t434*t41-t436*t38;
    dfr1[35] = t434*t37+t436*t40;
    dfr1[34] = dfr1[39];
    dfr1[33] = 2.0*dfr1[34]*t44;
    dfr1[32] = -dfr1[48]+dfr1[33]*t201;
    t446 = dfr1[32];
    dfr1[31] = -t434*t48+t446*t40;
    dfr1[30] = t436*t46+t446*t41;
    dfr1[29] = -t436*t48-t446*t37;
    dfr1[28] = t434*t46-t446*t38;
    dfr1[27] = 0.25*t402*t215-t420;
    dfr1[26] = -dfr1[55]*t220+dfr1[27]*t73/2.0;
    dfr1[25] = dfr1[26];
    dfr1[24] = 2.0*dfr1[25]*t33;
    dfr1[23] = dfr1[51]*t235+dfr1[24]*t230+t265;
    dfr1[22] = dfr1[25];
    dfr1[21] = 2.0*dfr1[22]*t28;
    dfr1[20] = -dfr1[49]+dfr1[21]*t243;
    t472 = dfr1[23];
    t474 = dfr1[20];
    dfr1[19] = t472*t18+t474*t15;
    dfr1[18] = -t472*t14-t474*t17;
    dfr1[17] = dfr1[22];
    dfr1[16] = 2.0*dfr1[17]*t21;
    dfr1[15] = dfr1[47]*t261+dfr1[16]*t256;
    t485 = dfr1[15];
    dfr1[14] = t472*t25-t485*t17;
    dfr1[13] = -t474*t23-t485*t18;
    dfr1[12] = t474*t25+t485*t14;
    dfr1[11] = -t472*t23+t485*t15;
    dfr1[10] = t416*t60;
    dfr1[9] = t416*t275+dfr1[10]*t278/2.0;
    dfr1[8] = dfr1[9];
    dfr1[7] = 2.0*dfr1[8]*t8;
    dfr1[6] = dfr1[7]*t284;
    dfr1[5] = dfr1[8];
    dfr1[4] = 2.0*dfr1[5]*t5;
    dfr1[3] = dfr1[4]*t288;
    dfr1[2] = dfr1[5];
    dfr1[1] = 2.0*dfr1[2]*t2;
    dfr1[0] = dfr1[1]*t292;
    dfr2[56] = t105*t64;
    dfr2[54] = t62*t64*t89;
    dfr2[53] = dfr2[54];
    t508 = dfr2[53]*t113;
    dfr2[52] = -0.25*t508*t117;
    dfr2[51] = -0.25*t508*t123;
    dfr2[50] = -0.25*t508*t130;
    dfr2[49] = dfr2[50]*t146;
    t518 = t105*t89;
    dfr2[48] = -0.25*t508*t149+t518;
    dfr2[47] = -0.25*t508*t155;
    dfr2[46] = t80*t64*t89;
    t523 = dfr2[46]*k;
    dfr2[45] = t523*t164;
    t527 = dfr2[45]*t172;
    dfr2[44] = 0.25*t508*t167-t527;
    t529 = t58*t58;
    t530 = 1/t529;
    dfr2[43] = -dfr2[56]*t530+dfr2[44]*t75/2.0;
    dfr2[42] = dfr2[43];
    dfr2[41] = 2.0*dfr2[42]*t56;
    dfr2[40] = -dfr2[52]+dfr2[41]*t180;
    dfr2[39] = dfr2[42];
    dfr2[38] = 2.0*dfr2[39]*t51;
    dfr2[37] = -0.25*t508*t185+dfr2[38]*t189;
    t546 = dfr2[40];
    t548 = dfr2[37];
    dfr2[36] = -t546*t41-t548*t38;
    dfr2[35] = t546*t37+t548*t40;
    dfr2[34] = dfr2[39];
    dfr2[33] = 2.0*dfr2[34]*t44;
    dfr2[32] = -dfr2[48]+dfr2[33]*t201;
    t558 = dfr2[32];
    dfr2[31] = -t546*t48+t558*t40;
    dfr2[30] = t548*t46+t558*t41;
    dfr2[29] = -t548*t48-t558*t37;
    dfr2[28] = t546*t46-t558*t38;
    dfr2[27] = 0.25*t508*t215-t527;
    dfr2[26] = dfr2[27]*t73/2.0;
    dfr2[25] = dfr2[26];
    dfr2[24] = 2.0*dfr2[25]*t33;
    dfr2[23] = dfr2[51]*t235+dfr2[24]*t230;
    dfr2[22] = dfr2[25];
    dfr2[21] = 2.0*dfr2[22]*t28;
    dfr2[20] = -dfr2[49]+dfr2[21]*t243;
    t581 = dfr2[23];
    t583 = dfr2[20];
    dfr2[19] = t581*t18+t583*t15;
    dfr2[18] = -t581*t14-t583*t17;
    dfr2[17] = dfr2[22];
    dfr2[16] = 2.0*dfr2[17]*t21;
    dfr2[15] = dfr2[47]*t261+dfr2[16]*t256;
    t594 = dfr2[15];
    dfr2[14] = t581*t25-t594*t17;
    dfr2[13] = -t583*t23-t594*t18;
    dfr2[12] = t583*t25+t594*t14;
    dfr2[11] = -t581*t23+t594*t15;
    dfr2[10] = t523*t60;
    dfr2[9] = t523*t275+dfr2[10]*t278/2.0;
    dfr2[8] = dfr2[9];
    dfr2[7] = 2.0*dfr2[8]*t8;
    dfr2[6] = dfr2[7]*t284;
    dfr2[5] = dfr2[8];
    dfr2[4] = 2.0*dfr2[5]*t5;
    dfr2[3] = dfr2[4]*t288;
    dfr2[2] = dfr2[5];
    dfr2[1] = 2.0*dfr2[2]*t2;
    dfr2[0] = dfr2[1]*t292;
    dfr3[56] = t105*t50;
    dfr3[54] = t62*t50*t89;
    dfr3[53] = dfr3[54];
    t617 = dfr3[53]*t113;
    dfr3[52] = -0.25*t617*t117;
    dfr3[51] = -0.25*t617*t123;
    dfr3[50] = -0.25*t617*t130;
    dfr3[49] = dfr3[50]*t146;
    dfr3[48] = -0.25*t617*t149;
    dfr3[47] = -0.25*t617*t155;
    dfr3[46] = t80*t50*t89;
    t631 = dfr3[46]*k;
    dfr3[45] = t631*t164;
    t635 = dfr3[45]*t172;
    dfr3[44] = 0.25*t617*t167-t635;
    dfr3[43] = -dfr3[56]*t530+dfr3[44]*t75/2.0;
    dfr3[42] = dfr3[43];
    dfr3[41] = 2.0*dfr3[42]*t56;
    dfr3[40] = -dfr3[52]+dfr3[41]*t180;
    dfr3[39] = dfr3[42];
    dfr3[38] = 2.0*dfr3[39]*t51;
    dfr3[37] = -0.25*t617*t185+dfr3[38]*t189+t518;
    t652 = dfr3[40];
    t654 = dfr3[37];
    dfr3[36] = -t652*t41-t654*t38;
    dfr3[35] = t652*t37+t654*t40;
    dfr3[34] = dfr3[39];
    dfr3[33] = 2.0*dfr3[34]*t44;
    dfr3[32] = -dfr3[48]+dfr3[33]*t201;
    t664 = dfr3[32];
    dfr3[31] = -t652*t48+t664*t40;
    dfr3[30] = t654*t46+t664*t41;
    dfr3[29] = -t654*t48-t664*t37;
    dfr3[28] = t652*t46-t664*t38;
    dfr3[27] = 0.25*t617*t215-t635;
    dfr3[26] = dfr3[27]*t73/2.0;
    dfr3[25] = dfr3[26];
    dfr3[24] = 2.0*dfr3[25]*t33;
    dfr3[23] = dfr3[51]*t235+dfr3[24]*t230;
    dfr3[22] = dfr3[25];
    dfr3[21] = 2.0*dfr3[22]*t28;
    dfr3[20] = -dfr3[49]+dfr3[21]*t243;
    t687 = dfr3[23];
    t689 = dfr3[20];
    dfr3[19] = t687*t18+t689*t15;
    dfr3[18] = -t687*t14-t689*t17;
    dfr3[17] = dfr3[22];
    dfr3[16] = 2.0*dfr3[17]*t21;
    dfr3[15] = dfr3[47]*t261+dfr3[16]*t256;
    t700 = dfr3[15];
    dfr3[14] = t687*t25-t700*t17;
    dfr3[13] = -t689*t23-t700*t18;
    dfr3[12] = t689*t25+t700*t14;
    dfr3[11] = -t687*t23+t700*t15;
    dfr3[10] = t631*t60;
    dfr3[9] = t631*t275+dfr3[10]*t278/2.0;
    dfr3[8] = dfr3[9];
    dfr3[7] = 2.0*dfr3[8]*t8;
    dfr3[6] = dfr3[7]*t284;
    dfr3[5] = dfr3[8];
    dfr3[4] = 2.0*dfr3[5]*t5;
    dfr3[3] = dfr3[4]*t288;
    dfr3[2] = dfr3[5];
    dfr3[1] = 2.0*dfr3[2]*t2;
    dfr3[0] = dfr3[1]*t292;
    dfr4[56] = t105*t70;
    dfr4[54] = t62*t70*t89;
    dfr4[53] = dfr4[54];
    t723 = dfr4[53]*t113;
    dfr4[52] = -0.25*t723*t117+t518;
    dfr4[51] = -0.25*t723*t123;
    dfr4[50] = -0.25*t723*t130;
    dfr4[49] = dfr4[50]*t146;
    dfr4[48] = -0.25*t723*t149;
    dfr4[47] = -0.25*t723*t155;
    dfr4[46] = t80*t70*t89;
    t737 = dfr4[46]*k;
    dfr4[45] = t737*t164;
    t741 = dfr4[45]*t172;
    dfr4[44] = 0.25*t723*t167-t741;
    dfr4[43] = -dfr4[56]*t530+dfr4[44]*t75/2.0;
    dfr4[42] = dfr4[43];
    dfr4[41] = 2.0*dfr4[42]*t56;
    dfr4[40] = -dfr4[52]+dfr4[41]*t180;
    dfr4[39] = dfr4[42];
    dfr4[38] = 2.0*dfr4[39]*t51;
    dfr4[37] = -0.25*t723*t185+dfr4[38]*t189;
    t758 = dfr4[40];
    t760 = dfr4[37];
    dfr4[36] = -t758*t41-t760*t38;
    dfr4[35] = t758*t37+t760*t40;
    dfr4[34] = dfr4[39];
    dfr4[33] = 2.0*dfr4[34]*t44;
    dfr4[32] = -dfr4[48]+dfr4[33]*t201;
    t770 = dfr4[32];
    dfr4[31] = -t758*t48+t770*t40;
    dfr4[30] = t760*t46+t770*t41;
    dfr4[29] = -t760*t48-t770*t37;
    dfr4[28] = t758*t46-t770*t38;
    dfr4[27] = 0.25*t723*t215-t741;
    dfr4[26] = dfr4[27]*t73/2.0;
    dfr4[25] = dfr4[26];
    dfr4[24] = 2.0*dfr4[25]*t33;
    dfr4[23] = dfr4[51]*t235+dfr4[24]*t230;
    dfr4[22] = dfr4[25];
    dfr4[21] = 2.0*dfr4[22]*t28;
    dfr4[20] = -dfr4[49]+dfr4[21]*t243;
    t793 = dfr4[23];
    t795 = dfr4[20];
    dfr4[19] = t793*t18+t795*t15;
    dfr4[18] = -t793*t14-t795*t17;
    dfr4[17] = dfr4[22];
    dfr4[16] = 2.0*dfr4[17]*t21;
    dfr4[15] = dfr4[47]*t261+dfr4[16]*t256;
    t806 = dfr4[15];
    dfr4[14] = t793*t25-t806*t17;
    dfr4[13] = -t795*t23-t806*t18;
    dfr4[12] = t795*t25+t806*t14;
    dfr4[11] = -t793*t23+t806*t15;
    dfr4[10] = t737*t60;
    dfr4[9] = t737*t275+dfr4[10]*t278/2.0;
    dfr4[8] = dfr4[9];
    dfr4[7] = 2.0*dfr4[8]*t8;
    dfr4[6] = dfr4[7]*t284;
    dfr4[5] = dfr4[8];
    dfr4[4] = 2.0*dfr4[5]*t5;
    dfr4[3] = dfr4[4]*t288;
    dfr4[2] = dfr4[5];
    dfr4[1] = 2.0*dfr4[2]*t2;
    dfr4[0] = dfr4[1]*t292;
    t827 = t95*t96;
    dfr5[72] = t827*t124;
    dfr5[71] = t827*t125;
    t828 = dfr5[71];
    dfr5[70] = t828*t107*t110;
    dfr5[69] = t828*t103*t110;
    dfr5[68] = t828*t99*t110;
    dfr5[67] = t827*t111;
    dfr5[66] = t827*t112;
    t833 = dfr5[66];
    dfr5[65] = t828*t90+t833*t85;
    dfr5[64] = t828*t121*t110+t833*t106*t110;
    dfr5[63] = t833*t107*t110;
    dfr5[62] = t828*t118*t110+t833*t102*t110;
    dfr5[61] = t833*t103*t110;
    dfr5[60] = t828*t115*t110+t833*t98*t110;
    dfr5[59] = t833*t99*t110;
    t852 = t111*t112+t124*t125;
    dfr5[58] = t95*t852;
    dfr5[57] = t96*t852;
    t853 = dfr5[72];
    dfr5[56] = t853*t64;
    t854 = dfr5[67];
    dfr5[55] = t854*t20;
    t855 = dfr5[58];
    dfr5[54] = t855*t61;
    dfr5[53] = dfr5[54];
    t857 = dfr5[53]*t113;
    dfr5[52] = -0.25*t857*t117;
    dfr5[51] = -0.25*t857*t123;
    dfr5[50] = -0.25*t857*t130;
    dfr5[49] = dfr5[50]*t146;
    dfr5[48] = t853*t89-0.25*t857*t149;
    dfr5[47] = -0.25*t857*t155;
    dfr5[45] = t855*t80;
    t873 = dfr5[45]*t172;
    dfr5[44] = 0.25*t857*t167-t873;
    dfr5[43] = -dfr5[56]*t530+dfr5[44]*t75/2.0;
    dfr5[42] = dfr5[43];
    dfr5[41] = 2.0*dfr5[42]*t56;
    dfr5[40] = -dfr5[52]+dfr5[41]*t180;
    dfr5[39] = dfr5[42];
    dfr5[38] = 2.0*dfr5[39]*t51;
    dfr5[37] = -0.25*t857*t185+dfr5[38]*t189;
    t892 = conjugate(t48);
    t894 = abs(1.0,-t48);
    t895 = (t48<0 ? -1 : 1);
    t899 = 1/t48*t892+2.0*t894/t895;
    t901 = dfr5[40];
    t903 = dfr5[37];
    dfr5[36] = dfr5[68]*t899-t901*t41-t903*t38;
    dfr5[35] = t901*t37+t903*t40;
    dfr5[34] = dfr5[39];
    dfr5[33] = 2.0*dfr5[34]*t44;
    dfr5[32] = -dfr5[48]+dfr5[33]*t201;
    t913 = dfr5[32];
    dfr5[31] = -t901*t48+t913*t40;
    t917 = conjugate(t40);
    t919 = abs(1.0,-t40);
    t920 = (t40<0 ? -1 : 1);
    t924 = 1/t40*t917+2.0*t919/t920;
    dfr5[30] = dfr5[70]*t924+t903*t46+t913*t41;
    dfr5[29] = -t903*t48-t913*t37;
    t932 = conjugate(t37);
    t934 = abs(1.0,-t37);
    t935 = (t37<0 ? -1 : 1);
    t939 = 1/t37*t932+2.0*t934/t935;
    dfr5[28] = dfr5[69]*t939+t901*t46-t913*t38;
    dfr5[27] = 0.25*t857*t215-t873;
    dfr5[26] = -dfr5[55]*t220+dfr5[27]*t73/2.0;
    dfr5[25] = dfr5[26];
    dfr5[24] = 2.0*dfr5[25]*t33;
    dfr5[23] = dfr5[51]*t235+dfr5[24]*t230;
    dfr5[22] = dfr5[25];
    dfr5[21] = 2.0*dfr5[22]*t28;
    dfr5[20] = -dfr5[49]+dfr5[21]*t243;
    t961 = dfr5[23];
    t963 = dfr5[20];
    dfr5[19] = t961*t18+t963*t15;
    t967 = conjugate(t23);
    t969 = abs(1.0,-t23);
    t970 = (t23<0 ? -1 : 1);
    t974 = 1/t23*t967+2.0*t969/t970;
    dfr5[18] = dfr5[59]*t974-t961*t14-t963*t17;
    dfr5[17] = dfr5[22];
    dfr5[16] = 2.0*dfr5[17]*t21;
    dfr5[15] = t854*t82+dfr5[47]*t261+dfr5[16]*t256;
    t987 = conjugate(t18);
    t989 = abs(1.0,-t18);
    t990 = (t18<0 ? -1 : 1);
    t994 = 1/t18*t987+2.0*t989/t990;
    t997 = dfr5[15];
    dfr5[14] = dfr5[61]*t994+t961*t25-t997*t17;
    dfr5[13] = -t963*t23-t997*t18;
    t1003 = conjugate(t15);
    t1005 = abs(1.0,-t15);
    t1006 = (t15<0 ? -1 : 1);
    t1010 = 1/t15*t1003+2.0*t1005/t1006;
    dfr5[12] = dfr5[63]*t1010+t963*t25+t997*t14;
    dfr5[11] = -t961*t23+t997*t15;
    t1017 = t11*t11;
    t1018 = 1/t1017;
    dfr5[10] = -dfr5[65]*t1018;
    dfr5[9] = dfr5[57]*k+dfr5[10]*t278/2.0;
    dfr5[8] = dfr5[9];
    dfr5[7] = 2.0*dfr5[8]*t8;
    dfr5[6] = -dfr5[64]+dfr5[7]*t284;
    dfr5[5] = dfr5[8];
    dfr5[4] = 2.0*dfr5[5]*t5;
    dfr5[3] = -dfr5[62]+dfr5[4]*t288;
    dfr5[2] = dfr5[5];
    dfr5[1] = 2.0*dfr5[2]*t2;
    dfr5[0] = -dfr5[60]+dfr5[1]*t292;
    dfr6[74] = dfr5[72];
    dfr6[73] = dfr5[67];
    dfr6[71] = t827*t131;
    t1040 = dfr6[71];
    dfr6[70] = t1040*t107*t110;
    dfr6[69] = t1040*t103*t110;
    dfr6[68] = t1040*t99*t110;
    dfr6[66] = t827*t129;
    t1045 = dfr6[66];
    dfr6[65] = t1040*t90+t1045*t85;
    dfr6[64] = t1040*t121*t110+t1045*t106*t110;
    dfr6[63] = t1045*t107*t110;
    dfr6[62] = t1040*t118*t110+t1045*t102*t110;
    dfr6[61] = t1045*t103*t110;
    dfr6[60] = t1040*t115*t110+t1045*t98*t110;
    dfr6[59] = t1045*t99*t110;
    t1064 = t111*t129+t124*t131;
    dfr6[58] = t95*t1064;
    dfr6[57] = t96*t1064;
    t1065 = dfr6[74];
    dfr6[56] = t1065*t50;
    t1066 = dfr6[73];
    dfr6[55] = t1066*t66;
    t1067 = dfr6[58];
    dfr6[54] = t1067*t61;
    dfr6[53] = dfr6[54];
    t1069 = dfr6[53]*t113;
    dfr6[52] = -0.25*t1069*t117;
    dfr6[51] = -0.25*t1069*t123;
    dfr6[50] = -0.25*t1069*t130;
    dfr6[49] = t1066*t82+dfr6[50]*t146;
    dfr6[48] = -0.25*t1069*t149;
    dfr6[47] = -0.25*t1069*t155;
    dfr6[45] = t1067*t80;
    t1086 = dfr6[45]*t172;
    dfr6[44] = 0.25*t1069*t167-t1086;
    dfr6[43] = -dfr6[56]*t530+dfr6[44]*t75/2.0;
    dfr6[42] = dfr6[43];
    dfr6[41] = 2.0*dfr6[42]*t56;
    dfr6[40] = -dfr6[52]+dfr6[41]*t180;
    dfr6[39] = dfr6[42];
    dfr6[38] = 2.0*dfr6[39]*t51;
    dfr6[37] = t1065*t89-0.25*t1069*t185+dfr6[38]*t189;
    t1106 = dfr6[40];
    t1108 = dfr6[37];
    dfr6[36] = dfr6[68]*t899-t1106*t41-t1108*t38;
    dfr6[35] = t1106*t37+t1108*t40;
    dfr6[34] = dfr6[39];
    dfr6[33] = 2.0*dfr6[34]*t44;
    dfr6[32] = -dfr6[48]+dfr6[33]*t201;
    t1118 = dfr6[32];
    dfr6[31] = -t1106*t48+t1118*t40;
    dfr6[30] = dfr6[70]*t924+t1108*t46+t1118*t41;
    dfr6[29] = -t1108*t48-t1118*t37;
    dfr6[28] = dfr6[69]*t939+t1106*t46-t1118*t38;
    dfr6[27] = 0.25*t1069*t215-t1086;
    dfr6[26] = -dfr6[55]*t220+dfr6[27]*t73/2.0;
    dfr6[25] = dfr6[26];
    dfr6[24] = 2.0*dfr6[25]*t33;
    dfr6[23] = dfr6[51]*t235+dfr6[24]*t230;
    dfr6[22] = dfr6[25];
    dfr6[21] = 2.0*dfr6[22]*t28;
    dfr6[20] = -dfr6[49]+dfr6[21]*t243;
    t1148 = dfr6[23];
    t1150 = dfr6[20];
    dfr6[19] = t1148*t18+t1150*t15;
    dfr6[18] = dfr6[59]*t974-t1148*t14-t1150*t17;
    dfr6[17] = dfr6[22];
    dfr6[16] = 2.0*dfr6[17]*t21;
    dfr6[15] = dfr6[47]*t261+dfr6[16]*t256;
    t1165 = dfr6[15];
    dfr6[14] = dfr6[61]*t994+t1148*t25-t1165*t17;
    dfr6[13] = -t1150*t23-t1165*t18;
    dfr6[12] = dfr6[63]*t1010+t1150*t25+t1165*t14;
    dfr6[11] = -t1148*t23+t1165*t15;
    dfr6[10] = -dfr6[65]*t1018;
    dfr6[9] = dfr6[57]*k+dfr6[10]*t278/2.0;
    dfr6[8] = dfr6[9];
    dfr6[7] = 2.0*dfr6[8]*t8;
    dfr6[6] = -dfr6[64]+dfr6[7]*t284;
    dfr6[5] = dfr6[8];
    dfr6[4] = 2.0*dfr6[5]*t5;
    dfr6[3] = -dfr6[62]+dfr6[4]*t288;
    dfr6[2] = dfr6[5];
    dfr6[1] = 2.0*dfr6[2]*t2;
    dfr6[0] = -dfr6[60]+dfr6[1]*t292;
    dfr7[76] = dfr6[74];
    dfr7[75] = dfr6[73];
    dfr7[71] = t827*t137;
    t1197 = dfr7[71];
    dfr7[70] = t1197*t107*t110;
    dfr7[69] = t1197*t103*t110;
    dfr7[68] = t1197*t99*t110;
    dfr7[66] = t827*t135;
    t1202 = dfr7[66];
    dfr7[65] = t1197*t90+t1202*t85;
    dfr7[64] = t1197*t121*t110+t1202*t106*t110;
    dfr7[63] = t1202*t107*t110;
    dfr7[62] = t1197*t118*t110+t1202*t102*t110;
    dfr7[61] = t1202*t103*t110;
    dfr7[60] = t1197*t115*t110+t1202*t98*t110;
    dfr7[59] = t1202*t99*t110;
    t1221 = t111*t135+t124*t137;
    dfr7[58] = t95*t1221;
    dfr7[57] = t96*t1221;
    t1222 = dfr7[76];
    dfr7[56] = t1222*t70;
    t1223 = dfr7[75];
    dfr7[55] = t1223*t32;
    t1224 = dfr7[58];
    dfr7[54] = t1224*t61;
    dfr7[53] = dfr7[54];
    t1227 = dfr7[53]*t113;
    dfr7[52] = t1222*t89-0.25*t1227*t117;
    dfr7[51] = -0.25*t1227*t123;
    dfr7[50] = -0.25*t1227*t130;
    dfr7[49] = dfr7[50]*t146;
    dfr7[48] = -0.25*t1227*t149;
    dfr7[47] = -0.25*t1227*t155;
    dfr7[45] = t1224*t80;
    t1242 = dfr7[45]*t172;
    dfr7[44] = 0.25*t1227*t167-t1242;
    dfr7[43] = -dfr7[56]*t530+dfr7[44]*t75/2.0;
    dfr7[42] = dfr7[43];
    dfr7[41] = 2.0*dfr7[42]*t56;
    dfr7[40] = -dfr7[52]+dfr7[41]*t180;
    dfr7[39] = dfr7[42];
    dfr7[38] = 2.0*dfr7[39]*t51;
    dfr7[37] = -0.25*t1227*t185+dfr7[38]*t189;
    t1261 = dfr7[40];
    t1263 = dfr7[37];
    dfr7[36] = dfr7[68]*t899-t1261*t41-t1263*t38;
    dfr7[35] = t1261*t37+t1263*t40;
    dfr7[34] = dfr7[39];
    dfr7[33] = 2.0*dfr7[34]*t44;
    dfr7[32] = -dfr7[48]+dfr7[33]*t201;
    t1273 = dfr7[32];
    dfr7[31] = -t1261*t48+t1273*t40;
    dfr7[30] = dfr7[70]*t924+t1263*t46+t1273*t41;
    dfr7[29] = -t1263*t48-t1273*t37;
    dfr7[28] = dfr7[69]*t939+t1261*t46-t1273*t38;
    dfr7[27] = 0.25*t1227*t215-t1242;
    dfr7[26] = -dfr7[55]*t220+dfr7[27]*t73/2.0;
    dfr7[25] = dfr7[26];
    dfr7[24] = 2.0*dfr7[25]*t33;
    dfr7[23] = t1223*t82+dfr7[51]*t235+dfr7[24]*t230;
    dfr7[22] = dfr7[25];
    dfr7[21] = 2.0*dfr7[22]*t28;
    dfr7[20] = -dfr7[49]+dfr7[21]*t243;
    t1304 = dfr7[23];
    t1306 = dfr7[20];
    dfr7[19] = t1304*t18+t1306*t15;
    dfr7[18] = dfr7[59]*t974-t1304*t14-t1306*t17;
    dfr7[17] = dfr7[22];
    dfr7[16] = 2.0*dfr7[17]*t21;
    dfr7[15] = dfr7[47]*t261+dfr7[16]*t256;
    t1321 = dfr7[15];
    dfr7[14] = dfr7[61]*t994+t1304*t25-t1321*t17;
    dfr7[13] = -t1306*t23-t1321*t18;
    dfr7[12] = dfr7[63]*t1010+t1306*t25+t1321*t14;
    dfr7[11] = -t1304*t23+t1321*t15;
    dfr7[10] = -dfr7[65]*t1018;
    dfr7[9] = dfr7[57]*k+dfr7[10]*t278/2.0;
    dfr7[8] = dfr7[9];
    dfr7[7] = 2.0*dfr7[8]*t8;
    dfr7[6] = -dfr7[64]+dfr7[7]*t284;
    dfr7[5] = dfr7[8];
    dfr7[4] = 2.0*dfr7[5]*t5;
    dfr7[3] = -dfr7[62]+dfr7[4]*t288;
    dfr7[2] = dfr7[5];
    dfr7[1] = 2.0*dfr7[2]*t2;
    dfr7[0] = -dfr7[60]+dfr7[1]*t292;
    dfr8[84] = dfr5[71];
    t1353 = dfr8[84];
    dfr8[83] = t1353*t107*t110;
    dfr8[82] = t1353*t103*t110;
    dfr8[81] = t1353*t99*t110;
    dfr8[80] = dfr5[66];
    t1357 = dfr8[80];
    dfr8[79] = t1357*t107*t110;
    dfr8[78] = t1357*t103*t110;
    dfr8[77] = t1357*t99*t110;
    dfr8[72] = t827*t163;
    dfr8[67] = t827*t151;
    dfr8[65] = t1353*t104+t1357*t94;
    dfr8[64] = t1353*t160*t110+t1357*t148*t110;
    dfr8[62] = t1353*t157*t110+t1357*t145*t110;
    dfr8[60] = t1353*t154*t110+t1357*t142*t110;
    t1377 = t151*t112+t163*t125;
    dfr8[58] = t95*t1377;
    dfr8[57] = t96*t1377;
    t1378 = dfr8[72];
    dfr8[56] = t1378*t64;
    t1379 = dfr8[67];
    dfr8[55] = t1379*t20;
    t1380 = dfr8[58];
    dfr8[54] = t1380*t61;
    dfr8[53] = dfr8[54];
    t1382 = dfr8[53]*t113;
    dfr8[52] = -0.25*t1382*t117;
    dfr8[51] = -0.25*t1382*t123;
    dfr8[50] = -0.25*t1382*t130;
    dfr8[49] = dfr8[50]*t146;
    dfr8[48] = t1378*t89-0.25*t1382*t149;
    dfr8[47] = -0.25*t1382*t155;
    dfr8[45] = t1380*t80;
    t1398 = dfr8[45]*t172;
    dfr8[44] = 0.25*t1382*t167-t1398;
    dfr8[43] = -dfr8[56]*t530+dfr8[44]*t75/2.0;
    dfr8[42] = dfr8[43];
    dfr8[41] = 2.0*dfr8[42]*t56;
    dfr8[40] = -dfr8[52]+dfr8[41]*t180;
    dfr8[39] = dfr8[42];
    dfr8[38] = 2.0*dfr8[39]*t51;
    dfr8[37] = -0.25*t1382*t185+dfr8[38]*t189;
    t1415 = dfr8[40];
    t1417 = dfr8[37];
    dfr8[36] = -t1415*t41-t1417*t38;
    t1421 = conjugate(t46);
    t1423 = abs(1.0,-t46);
    t1424 = (t46<0 ? -1 : 1);
    t1428 = 1/t46*t1421+2.0*t1423/t1424;
    dfr8[35] = dfr8[81]*t1428+t1415*t37+t1417*t40;
    dfr8[34] = dfr8[39];
    dfr8[33] = 2.0*dfr8[34]*t44;
    dfr8[32] = -dfr8[48]+dfr8[33]*t201;
    t1439 = conjugate(t41);
    t1441 = abs(1.0,-t41);
    t1442 = (t41<0 ? -1 : 1);
    t1446 = 1/t41*t1439+2.0*t1441/t1442;
    t1449 = dfr8[32];
    dfr8[31] = dfr8[82]*t1446-t1415*t48+t1449*t40;
    dfr8[30] = t1417*t46+t1449*t41;
    t1455 = conjugate(t38);
    t1457 = abs(1.0,-t38);
    t1458 = (t38<0 ? -1 : 1);
    t1462 = 1/t38*t1455+2.0*t1457/t1458;
    dfr8[29] = dfr8[83]*t1462-t1417*t48-t1449*t37;
    dfr8[28] = t1415*t46-t1449*t38;
    dfr8[27] = 0.25*t1382*t215-t1398;
    dfr8[26] = -dfr8[55]*t220+dfr8[27]*t73/2.0;
    dfr8[25] = dfr8[26];
    dfr8[24] = 2.0*dfr8[25]*t33;
    dfr8[23] = dfr8[51]*t235+dfr8[24]*t230;
    dfr8[22] = dfr8[25];
    dfr8[21] = 2.0*dfr8[22]*t28;
    dfr8[20] = -dfr8[49]+dfr8[21]*t243;
    t1488 = conjugate(t25);
    t1490 = abs(1.0,-t25);
    t1491 = (t25<0 ? -1 : 1);
    t1495 = 1/t25*t1488+2.0*t1490/t1491;
    t1497 = dfr8[23];
    t1499 = dfr8[20];
    dfr8[19] = dfr8[77]*t1495+t1497*t18+t1499*t15;
    dfr8[18] = -t1497*t14-t1499*t17;
    dfr8[17] = dfr8[22];
    dfr8[16] = 2.0*dfr8[17]*t21;
    dfr8[15] = t1379*t82+dfr8[47]*t261+dfr8[16]*t256;
    t1511 = dfr8[15];
    dfr8[14] = t1497*t25-t1511*t17;
    t1515 = conjugate(t17);
    t1517 = abs(1.0,-t17);
    t1518 = (t17<0 ? -1 : 1);
    t1522 = 1/t17*t1515+2.0*t1517/t1518;
    dfr8[13] = dfr8[79]*t1522-t1499*t23-t1511*t18;
    dfr8[12] = t1499*t25+t1511*t14;
    t1530 = conjugate(t14);
    t1532 = abs(1.0,-t14);
    t1533 = (t14<0 ? -1 : 1);
    t1537 = 1/t14*t1530+2.0*t1532/t1533;
    dfr8[11] = dfr8[78]*t1537-t1497*t23+t1511*t15;
    dfr8[10] = -dfr8[65]*t1018;
    dfr8[9] = dfr8[57]*k+dfr8[10]*t278/2.0;
    dfr8[8] = dfr8[9];
    dfr8[7] = 2.0*dfr8[8]*t8;
    dfr8[6] = -dfr8[64]+dfr8[7]*t284;
    dfr8[5] = dfr8[8];
    dfr8[4] = 2.0*dfr8[5]*t5;
    dfr8[3] = -dfr8[62]+dfr8[4]*t288;
    dfr8[2] = dfr8[5];
    dfr8[1] = 2.0*dfr8[2]*t2;
    dfr8[0] = -dfr8[60]+dfr8[1]*t292;
    dfr9[84] = dfr6[71];
    t1563 = dfr9[84];
    dfr9[83] = t1563*t107*t110;
    dfr9[82] = t1563*t103*t110;
    dfr9[81] = t1563*t99*t110;
    dfr9[80] = dfr6[66];
    t1567 = dfr9[80];
    dfr9[79] = t1567*t107*t110;
    dfr9[78] = t1567*t103*t110;
    dfr9[77] = t1567*t99*t110;
    dfr9[74] = dfr8[72];
    dfr9[73] = dfr8[67];
    dfr9[65] = t1563*t104+t1567*t94;
    dfr9[64] = t1563*t160*t110+t1567*t148*t110;
    dfr9[62] = t1563*t157*t110+t1567*t145*t110;
    dfr9[60] = t1563*t154*t110+t1567*t142*t110;
    t1587 = t151*t129+t163*t131;
    dfr9[58] = t95*t1587;
    dfr9[57] = t96*t1587;
    t1588 = dfr9[74];
    dfr9[56] = t1588*t50;
    t1589 = dfr9[73];
    dfr9[55] = t1589*t66;
    t1590 = dfr9[58];
    dfr9[54] = t1590*t61;
    dfr9[53] = dfr9[54];
    t1592 = dfr9[53]*t113;
    dfr9[52] = -0.25*t1592*t117;
    dfr9[51] = -0.25*t1592*t123;
    dfr9[50] = -0.25*t1592*t130;
    dfr9[49] = t1589*t82+dfr9[50]*t146;
    dfr9[48] = -0.25*t1592*t149;
    dfr9[47] = -0.25*t1592*t155;
    dfr9[45] = t1590*t80;
    t1609 = dfr9[45]*t172;
    dfr9[44] = 0.25*t1592*t167-t1609;
    dfr9[43] = -dfr9[56]*t530+dfr9[44]*t75/2.0;
    dfr9[42] = dfr9[43];
    dfr9[41] = 2.0*dfr9[42]*t56;
    dfr9[40] = -dfr9[52]+dfr9[41]*t180;
    dfr9[39] = dfr9[42];
    dfr9[38] = 2.0*dfr9[39]*t51;
    dfr9[37] = t1588*t89-0.25*t1592*t185+dfr9[38]*t189;
    t1627 = dfr9[40];
    t1629 = dfr9[37];
    dfr9[36] = -t1627*t41-t1629*t38;
    dfr9[35] = dfr9[81]*t1428+t1627*t37+t1629*t40;
    dfr9[34] = dfr9[39];
    dfr9[33] = 2.0*dfr9[34]*t44;
    dfr9[32] = -dfr9[48]+dfr9[33]*t201;
    t1643 = dfr9[32];
    dfr9[31] = dfr9[82]*t1446-t1627*t48+t1643*t40;
    dfr9[30] = t1629*t46+t1643*t41;
    dfr9[29] = dfr9[83]*t1462-t1629*t48-t1643*t37;
    dfr9[28] = t1627*t46-t1643*t38;
    dfr9[27] = 0.25*t1592*t215-t1609;
    dfr9[26] = -dfr9[55]*t220+dfr9[27]*t73/2.0;
    dfr9[25] = dfr9[26];
    dfr9[24] = 2.0*dfr9[25]*t33;
    dfr9[23] = dfr9[51]*t235+dfr9[24]*t230;
    dfr9[22] = dfr9[25];
    dfr9[21] = 2.0*dfr9[22]*t28;
    dfr9[20] = -dfr9[49]+dfr9[21]*t243;
    t1673 = dfr9[23];
    t1675 = dfr9[20];
    dfr9[19] = dfr9[77]*t1495+t1673*t18+t1675*t15;
    dfr9[18] = -t1673*t14-t1675*t17;
    dfr9[17] = dfr9[22];
    dfr9[16] = 2.0*dfr9[17]*t21;
    dfr9[15] = dfr9[47]*t261+dfr9[16]*t256;
    t1686 = dfr9[15];
    dfr9[14] = t1673*t25-t1686*t17;
    dfr9[13] = dfr9[79]*t1522-t1675*t23-t1686*t18;
    dfr9[12] = t1675*t25+t1686*t14;
    dfr9[11] = dfr9[78]*t1537-t1673*t23+t1686*t15;
    dfr9[10] = -dfr9[65]*t1018;
    dfr9[9] = dfr9[57]*k+dfr9[10]*t278/2.0;
    dfr9[8] = dfr9[9];
    dfr9[7] = 2.0*dfr9[8]*t8;
    dfr9[6] = -dfr9[64]+dfr9[7]*t284;
    dfr9[5] = dfr9[8];
    dfr9[4] = 2.0*dfr9[5]*t5;
    dfr9[3] = -dfr9[62]+dfr9[4]*t288;
    dfr9[2] = dfr9[5];
    dfr9[1] = 2.0*dfr9[2]*t2;
    dfr9[0] = -dfr9[60]+dfr9[1]*t292;
    dfr10[84] = dfr7[71];
    t1720 = dfr10[84];
    dfr10[83] = t1720*t107*t110;
    dfr10[82] = t1720*t103*t110;
    dfr10[81] = t1720*t99*t110;
    dfr10[80] = dfr7[66];
    t1724 = dfr10[80];
    dfr10[79] = t1724*t107*t110;
    dfr10[78] = t1724*t103*t110;
    dfr10[77] = t1724*t99*t110;
    dfr10[76] = dfr9[74];
    dfr10[75] = dfr9[73];
    dfr10[65] = t1720*t104+t1724*t94;
    dfr10[64] = t1720*t160*t110+t1724*t148*t110;
    dfr10[62] = t1720*t157*t110+t1724*t145*t110;
    dfr10[60] = t1720*t154*t110+t1724*t142*t110;
    t1744 = t151*t135+t163*t137;
    dfr10[58] = t95*t1744;
    dfr10[57] = t96*t1744;
    t1745 = dfr10[76];
    dfr10[56] = t1745*t70;
    t1746 = dfr10[75];
    dfr10[55] = t1746*t32;
    t1747 = dfr10[58];
    dfr10[54] = t1747*t61;
    dfr10[53] = dfr10[54];
    t1750 = dfr10[53]*t113;
    dfr10[52] = t1745*t89-0.25*t1750*t117;
    dfr10[51] = -0.25*t1750*t123;
    dfr10[50] = -0.25*t1750*t130;
    dfr10[49] = dfr10[50]*t146;
    dfr10[48] = -0.25*t1750*t149;
    dfr10[47] = -0.25*t1750*t155;
    dfr10[45] = t1747*t80;
    t1765 = dfr10[45]*t172;
    dfr10[44] = 0.25*t1750*t167-t1765;
    dfr10[43] = -dfr10[56]*t530+dfr10[44]*t75/2.0;
    dfr10[42] = dfr10[43];
    dfr10[41] = 2.0*dfr10[42]*t56;
    dfr10[40] = -dfr10[52]+dfr10[41]*t180;
    dfr10[39] = dfr10[42];
    dfr10[38] = 2.0*dfr10[39]*t51;
    dfr10[37] = -0.25*t1750*t185+dfr10[38]*t189;
    t1782 = dfr10[40];
    t1784 = dfr10[37];
    dfr10[36] = -t1782*t41-t1784*t38;
    dfr10[35] = dfr10[81]*t1428+t1782*t37+t1784*t40;
    dfr10[34] = dfr10[39];
    dfr10[33] = 2.0*dfr10[34]*t44;
    dfr10[32] = -dfr10[48]+dfr10[33]*t201;
    t1798 = dfr10[32];
    dfr10[31] = dfr10[82]*t1446-t1782*t48+t1798*t40;
    dfr10[30] = t1784*t46+t1798*t41;
    dfr10[29] = dfr10[83]*t1462-t1784*t48-t1798*t37;
    dfr10[28] = t1782*t46-t1798*t38;
    dfr10[27] = 0.25*t1750*t215-t1765;
    dfr10[26] = -dfr10[55]*t220+dfr10[27]*t73/2.0;
    dfr10[25] = dfr10[26];
    dfr10[24] = 2.0*dfr10[25]*t33;
    dfr10[23] = t1746*t82+dfr10[51]*t235+dfr10[24]*t230;
    dfr10[22] = dfr10[25];
    dfr10[21] = 2.0*dfr10[22]*t28;
    dfr10[20] = -dfr10[49]+dfr10[21]*t243;
    t1829 = dfr10[23];
    t1831 = dfr10[20];
    dfr10[19] = dfr10[77]*t1495+t1829*t18+t1831*t15;
    dfr10[18] = -t1829*t14-t1831*t17;
    dfr10[17] = dfr10[22];
    dfr10[16] = 2.0*dfr10[17]*t21;
    dfr10[15] = dfr10[47]*t261+dfr10[16]*t256;
    t1842 = dfr10[15];
    dfr10[14] = t1829*t25-t1842*t17;
    dfr10[13] = dfr10[79]*t1522-t1831*t23-t1842*t18;
    dfr10[12] = t1831*t25+t1842*t14;
    dfr10[11] = dfr10[78]*t1537-t1829*t23+t1842*t15;
    dfr10[10] = -dfr10[65]*t1018;
    dfr10[9] = dfr10[57]*k+dfr10[10]*t278/2.0;
    dfr10[8] = dfr10[9];
    dfr10[7] = 2.0*dfr10[8]*t8;
    dfr10[6] = -dfr10[64]+dfr10[7]*t284;
    dfr10[5] = dfr10[8];
    dfr10[4] = 2.0*dfr10[5]*t5;
    dfr10[3] = -dfr10[62]+dfr10[4]*t288;
    dfr10[2] = dfr10[5];
    dfr10[1] = 2.0*dfr10[2]*t2;
    dfr10[0] = -dfr10[60]+dfr10[1]*t292;
    t1876 = df[19];
    t1877 = df[18];
    grd[0][0] = -t1876-t1877;
    t1878 = df[14];
    t1879 = df[11];
    grd[0][1] = -t1878-t1879;
    t1880 = df[13];
    t1881 = df[12];
    grd[0][2] = -t1880-t1881;
    t1882 = df[36];
    t1883 = df[35];
    grd[0][3] = -t1882-t1883;
    t1884 = df[31];
    t1885 = df[28];
    grd[0][4] = -t1884-t1885;
    t1886 = df[30];
    t1887 = df[29];
    grd[0][5] = -t1886-t1887;
    t1888 = df[0];
    grd[0][6] = t1883+t1876+t1888;
    t1889 = df[3];
    grd[0][7] = t1884+t1879+t1889;
    t1890 = df[6];
    grd[0][8] = t1887+t1880+t1890;
    grd[0][9] = t1882+t1877-t1888;
    grd[0][10] = t1885+t1878-t1889;
    grd[0][11] = t1886+t1881-t1890;
    t1891 = dfr0[19];
    t1892 = dfr0[18];
    grd[1][0] = -t1891-t1892;
    t1893 = dfr0[14];
    t1894 = dfr0[11];
    grd[1][1] = -t1893-t1894;
    t1895 = dfr0[13];
    t1896 = dfr0[12];
    grd[1][2] = -t1895-t1896;
    t1897 = dfr0[36];
    t1898 = dfr0[35];
    grd[1][3] = -t1897-t1898;
    t1899 = dfr0[31];
    t1900 = dfr0[28];
    grd[1][4] = -t1899-t1900;
    t1901 = dfr0[30];
    t1902 = dfr0[29];
    grd[1][5] = -t1901-t1902;
    t1903 = dfr0[0];
    grd[1][6] = t1898+t1891+t1903;
    t1904 = dfr0[3];
    grd[1][7] = t1899+t1894+t1904;
    t1905 = dfr0[6];
    grd[1][8] = t1902+t1895+t1905;
    grd[1][9] = t1897+t1892-t1903;
    grd[1][10] = t1900+t1893-t1904;
    grd[1][11] = t1901+t1896-t1905;
    t1906 = dfr1[19];
    t1907 = dfr1[18];
    grd[2][0] = -t1906-t1907;
    t1908 = dfr1[14];
    t1909 = dfr1[11];
    grd[2][1] = -t1908-t1909;
    t1910 = dfr1[13];
    t1911 = dfr1[12];
    grd[2][2] = -t1910-t1911;
    t1912 = dfr1[36];
    t1913 = dfr1[35];
    grd[2][3] = -t1912-t1913;
    t1914 = dfr1[31];
    t1915 = dfr1[28];
    grd[2][4] = -t1914-t1915;
    t1916 = dfr1[30];
    t1917 = dfr1[29];
    grd[2][5] = -t1916-t1917;
    t1918 = dfr1[0];
    grd[2][6] = t1913+t1906+t1918;
    t1919 = dfr1[3];
    grd[2][7] = t1914+t1909+t1919;
    t1920 = dfr1[6];
    grd[2][8] = t1917+t1910+t1920;
    grd[2][9] = t1912+t1907-t1918;
    grd[2][10] = t1915+t1908-t1919;
    grd[2][11] = t1916+t1911-t1920;
    t1921 = dfr2[19];
    t1922 = dfr2[18];
    grd[3][0] = -t1921-t1922;
    t1923 = dfr2[14];
    t1924 = dfr2[11];
    grd[3][1] = -t1923-t1924;
    t1925 = dfr2[13];
    t1926 = dfr2[12];
    grd[3][2] = -t1925-t1926;
    t1927 = dfr2[36];
    t1928 = dfr2[35];
    grd[3][3] = -t1927-t1928;
    t1929 = dfr2[31];
    t1930 = dfr2[28];
    grd[3][4] = -t1929-t1930;
    t1931 = dfr2[30];
    t1932 = dfr2[29];
    grd[3][5] = -t1931-t1932;
    t1933 = dfr2[0];
    grd[3][6] = t1928+t1921+t1933;
    t1934 = dfr2[3];
    grd[3][7] = t1929+t1924+t1934;
    t1935 = dfr2[6];
    grd[3][8] = t1932+t1925+t1935;
    grd[3][9] = t1927+t1922-t1933;
    grd[3][10] = t1930+t1923-t1934;
    grd[3][11] = t1931+t1926-t1935;
    t1936 = dfr3[19];
    t1937 = dfr3[18];
    grd[4][0] = -t1936-t1937;
    t1938 = dfr3[14];
    t1939 = dfr3[11];
    grd[4][1] = -t1938-t1939;
    t1940 = dfr3[13];
    t1941 = dfr3[12];
    grd[4][2] = -t1940-t1941;
    t1942 = dfr3[36];
    t1943 = dfr3[35];
    grd[4][3] = -t1942-t1943;
    t1944 = dfr3[31];
    t1945 = dfr3[28];
    grd[4][4] = -t1944-t1945;
    t1946 = dfr3[30];
    t1947 = dfr3[29];
    grd[4][5] = -t1946-t1947;
    t1948 = dfr3[0];
    grd[4][6] = t1943+t1936+t1948;
    t1949 = dfr3[3];
    grd[4][7] = t1944+t1939+t1949;
    t1950 = dfr3[6];
    grd[4][8] = t1947+t1940+t1950;
    grd[4][9] = t1942+t1937-t1948;
    grd[4][10] = t1945+t1938-t1949;
    grd[4][11] = t1946+t1941-t1950;
    t1951 = dfr4[19];
    t1952 = dfr4[18];
    grd[5][0] = -t1951-t1952;
    t1953 = dfr4[14];
    t1954 = dfr4[11];
    grd[5][1] = -t1953-t1954;
    t1955 = dfr4[13];
    t1956 = dfr4[12];
    grd[5][2] = -t1955-t1956;
    t1957 = dfr4[36];
    t1958 = dfr4[35];
    grd[5][3] = -t1957-t1958;
    t1959 = dfr4[31];
    t1960 = dfr4[28];
    grd[5][4] = -t1959-t1960;
    t1961 = dfr4[30];
    t1962 = dfr4[29];
    grd[5][5] = -t1961-t1962;
    t1963 = dfr4[0];
    grd[5][6] = t1958+t1951+t1963;
    t1964 = dfr4[3];
    grd[5][7] = t1959+t1954+t1964;
    t1965 = dfr4[6];
    grd[5][8] = t1962+t1955+t1965;
    grd[5][9] = t1957+t1952-t1963;
    grd[5][10] = t1960+t1953-t1964;
    grd[5][11] = t1961+t1956-t1965;
    t1966 = dfr5[19];
    t1967 = dfr5[18];
    grd[6][0] = -t1966-t1967;
    t1968 = dfr5[14];
    t1969 = dfr5[11];
    grd[6][1] = -t1968-t1969;
    t1970 = dfr5[13];
    t1971 = dfr5[12];
    grd[6][2] = -t1970-t1971;
    t1972 = dfr5[36];
    t1973 = dfr5[35];
    grd[6][3] = -t1972-t1973;
    t1974 = dfr5[31];
    t1975 = dfr5[28];
    grd[6][4] = -t1974-t1975;
    t1976 = dfr5[30];
    t1977 = dfr5[29];
    grd[6][5] = -t1976-t1977;
    t1978 = dfr5[0];
    grd[6][6] = t1973+t1966+t1978;
    t1979 = dfr5[3];
    grd[6][7] = t1974+t1969+t1979;
    t1980 = dfr5[6];
    grd[6][8] = t1977+t1970+t1980;
    grd[6][9] = t1972+t1967-t1978;
    grd[6][10] = t1975+t1968-t1979;
    grd[6][11] = t1976+t1971-t1980;
    t1981 = dfr6[19];
    t1982 = dfr6[18];
    grd[7][0] = -t1981-t1982;
    t1983 = dfr6[14];
    t1984 = dfr6[11];
    grd[7][1] = -t1983-t1984;
    t1985 = dfr6[13];
    t1986 = dfr6[12];
    grd[7][2] = -t1985-t1986;
    t1987 = dfr6[36];
    t1988 = dfr6[35];
    grd[7][3] = -t1987-t1988;
    t1989 = dfr6[31];
    t1990 = dfr6[28];
    grd[7][4] = -t1989-t1990;
    t1991 = dfr6[30];
    t1992 = dfr6[29];
    grd[7][5] = -t1991-t1992;
    t1993 = dfr6[0];
    grd[7][6] = t1988+t1981+t1993;
    t1994 = dfr6[3];
    grd[7][7] = t1989+t1984+t1994;
    t1995 = dfr6[6];
    grd[7][8] = t1992+t1985+t1995;
    grd[7][9] = t1987+t1982-t1993;
    grd[7][10] = t1990+t1983-t1994;
    grd[7][11] = t1991+t1986-t1995;
    t1996 = dfr7[19];
    t1997 = dfr7[18];
    grd[8][0] = -t1996-t1997;
    t1998 = dfr7[14];
    t1999 = dfr7[11];
    grd[8][1] = -t1998-t1999;
    t2000 = dfr7[13];
    t2001 = dfr7[12];
    grd[8][2] = -t2000-t2001;
    t2002 = dfr7[36];
    t2003 = dfr7[35];
    grd[8][3] = -t2002-t2003;
    t2004 = dfr7[31];
    t2005 = dfr7[28];
    grd[8][4] = -t2004-t2005;
    t2006 = dfr7[30];
    t2007 = dfr7[29];
    grd[8][5] = -t2006-t2007;
    t2008 = dfr7[0];
    grd[8][6] = t2003+t1996+t2008;
    t2009 = dfr7[3];
    grd[8][7] = t2004+t1999+t2009;
    t2010 = dfr7[6];
    grd[8][8] = t2007+t2000+t2010;
    grd[8][9] = t2002+t1997-t2008;
    grd[8][10] = t2005+t1998-t2009;
    grd[8][11] = t2006+t2001-t2010;
    t2011 = dfr8[19];
    t2012 = dfr8[18];
    grd[9][0] = -t2011-t2012;
    t2013 = dfr8[14];
    t2014 = dfr8[11];
    grd[9][1] = -t2013-t2014;
    t2015 = dfr8[13];
    t2016 = dfr8[12];
    grd[9][2] = -t2015-t2016;
    t2017 = dfr8[36];
    t2018 = dfr8[35];
    grd[9][3] = -t2017-t2018;
    t2019 = dfr8[31];
    t2020 = dfr8[28];
    grd[9][4] = -t2019-t2020;
    t2021 = dfr8[30];
    t2022 = dfr8[29];
    grd[9][5] = -t2021-t2022;
    t2023 = dfr8[0];
    grd[9][6] = t2018+t2011+t2023;
    t2024 = dfr8[3];
    grd[9][7] = t2019+t2014+t2024;
    t2025 = dfr8[6];
    grd[9][8] = t2022+t2015+t2025;
    grd[9][9] = t2017+t2012-t2023;
    grd[9][10] = t2020+t2013-t2024;
    grd[9][11] = t2021+t2016-t2025;
    t2026 = dfr9[19];
    t2027 = dfr9[18];
    grd[10][0] = -t2026-t2027;
    t2028 = dfr9[14];
    t2029 = dfr9[11];
    grd[10][1] = -t2028-t2029;
    t2030 = dfr9[13];
    t2031 = dfr9[12];
    grd[10][2] = -t2030-t2031;
    t2032 = dfr9[36];
    t2033 = dfr9[35];
    grd[10][3] = -t2032-t2033;
    t2034 = dfr9[31];
    t2035 = dfr9[28];
    grd[10][4] = -t2034-t2035;
    t2036 = dfr9[30];
    t2037 = dfr9[29];
    grd[10][5] = -t2036-t2037;
    t2038 = dfr9[0];
    grd[10][6] = t2033+t2026+t2038;
    t2039 = dfr9[3];
    grd[10][7] = t2034+t2029+t2039;
    t2040 = dfr9[6];
    grd[10][8] = t2037+t2030+t2040;
    grd[10][9] = t2032+t2027-t2038;
    grd[10][10] = t2035+t2028-t2039;
    grd[10][11] = t2036+t2031-t2040;
    t2041 = dfr10[19];
    t2042 = dfr10[18];
    grd[11][0] = -t2041-t2042;
    t2043 = dfr10[14];
    t2044 = dfr10[11];
    grd[11][1] = -t2043-t2044;
    t2045 = dfr10[13];
    t2046 = dfr10[12];
    grd[11][2] = -t2045-t2046;
    t2047 = dfr10[36];
    t2048 = dfr10[35];
    grd[11][3] = -t2047-t2048;
    t2049 = dfr10[31];
    t2050 = dfr10[28];
    grd[11][4] = -t2049-t2050;
    t2051 = dfr10[30];
    t2052 = dfr10[29];
    grd[11][5] = -t2051-t2052;
    t2053 = dfr10[0];
    grd[11][6] = t2048+t2041+t2053;
    t2054 = dfr10[3];
    grd[11][7] = t2049+t2044+t2054;
    t2055 = dfr10[6];
    grd[11][8] = t2052+t2045+t2055;
    grd[11][9] = t2047+t2042-t2053;
    grd[11][10] = t2050+t2043-t2054;
    grd[11][11] = t2051+t2046-t2055;
    return;
  
	}
}

//> cost(optimize(J));
//       1667 storage + 1428 assignments + 679 additions + 81 functions
//                    + 1380 multiplications + 44 divisions + 1766 subscripts


inline void computeBendingForceBridson(
		const Vector3d &x1, const Vector3d &x2, const Vector3d &x3, const Vector3d &x4, 
		const CMeMaterialProperty &mtl, //material parameters
		const double & sintheta0,
		Vector3d F[4],					//force in global coord.
		double3x3 *ppJacobian[4], 		//jocobian matrices, if needed (not NULL)
		double & signoftheta)
{

	Vector3d E = x4 - x3;
	const double e2 = Magnitude2(E);
	const double e1 = sqrt(e2);

	Vector3d N1 = CrossProd(x1-x3, x1-x4);
	const double N1len2 = Magnitude2(N1);
	const double N1len1 = sqrt(N1len2);
	Vector3d N2 = CrossProd(x2-x4, x2-x3);
	const double N2len2 = Magnitude2(N2);
	const double N2len1 = sqrt(N2len2);

	const Vector3d u1 = (e1/N1len2) * N1;
	const Vector3d u2 = (e1/N2len2) * N2;
	const Vector3d u3 = (DotProd((x1-x4), E)/(e1*N1len2)) * N1 + (DotProd(x2-x4, E)/(e1*N2len2))*N2;
	const Vector3d u4 = (DotProd((x1-x3), E)/(e1*N1len2)) * N1 - (DotProd(x2-x3, E)/(e1*N2len2))*N2;
	const double Ke = mtl.getYoung();
	const double KK = Ke*e2/(N1len1+N2len1);
	double sintheta2 = sqrt((1.0- DotProd(N1, N2)/(N1len1*N2len2))*0.50);
	signoftheta = DotProd(CrossProd(N1, N2), E);
	if (signoftheta<0) sintheta2 = -sintheta2;
	const double KKK = KK*(sintheta2 - sintheta0);

	F[0] = KKK * u1;
	F[1] = KKK * u2;
	F[2] = KKK * u3;
	F[3] = KKK * u4;

	const Vector3d v1(0);
	const Vector3d v2(0);
	const Vector3d v3(0);
	const Vector3d v4(0);
	const double DthetaDt = DotProd(u1, v1)+DotProd(u2,v2)+DotProd(u3,v3)+DotProd(u4,v4);
	const double KD = -2*e1* DthetaDt;
	F[0]+= KD*u1;
	F[1]+= KD*u2;
	F[2]+= KD*u3;
	F[3]+= KD*u4;
}


void CHindgeElement::init(const Vector3d &p1, const Vector3d &p2, const Vector3d &p3, const Vector3d &p4, const double& thickness)
{
	const Vector3d e = p4 - p3;
	const Vector3d p13 = p1 - p3;
	const Vector3d p23 = p2 - p3;
	Vector3d n1 = CrossProd(e, p13); n1.Normalize();
	Vector3d n2 = CrossProd(p23, e); n2.Normalize();
	const double dotn1n2 = DotProd(n1, n2);
	m_sintheta0 = sqrt((1.0-dotn1n2)*0.5);
	const double signval = DotProd(CrossProd(n1, n2), e);
	if (signval<0) m_sintheta0 = -m_sintheta0;
}


CHindgeElement::CHindgeElement(void)
{
	m_sintheta0 = 0;
}

void CHindgeElement::saveStiffness(CSparseMatrix33 *p, const double3x3 jac[])
{

}

inline void copyStiffnessMat(const double grad[12][12], const int i, const int j, double3x3 &jac)
{
	int ii = i*3;
	const int jj = j*3;
	double *x= jac.x;
	x[0]=grad[ii][jj]; x[1]=grad[ii][jj+1]; x[2]=grad[ii][jj+2]; ii++;
	x[0]=grad[ii][jj]; x[1]=grad[ii][jj+1]; x[2]=grad[ii][jj+2]; ii++;
	x[0]=grad[ii][jj]; x[1]=grad[ii][jj+1]; x[2]=grad[ii][jj+2]; ii++;
}


void CHindgeElement::computeForce(
	const Vector3d &p0, const Vector3d &p1, const Vector3d &p2, const Vector3d &p3, 
	const CMeMaterialProperty &mtl, //material parameters
	Vector3d F[4],					//force in global coord.
	double3x3 *ppJacobian[16])		//jocobian matrices, if needed (not NULL)
{
	//elastic force
	double signoftheta;
	computeBendingForceBridson(p0, p1, p2, p3, mtl, m_sintheta0, F, ppJacobian, signoftheta);

	//jacobian of the forces, stiffness matrix
	double grd[12][12];	
	double K= -mtl.getYoung();
	if (signoftheta<0) K=-K;
	J(p0.x, p0.y, p0.z, p1.x, p1.y, p1.z, p2.x, p2.y, p2.z, p3.x, p3.y, p3.z,
		K, m_sintheta0, grd);

	int k = 0;
	for (int j=0; j<4; j++){
		for (int i=0; i<4; i++, k++){
			copyStiffnessMat(grd, i, j, *ppJacobian[k]);
		}
	}

}

//===========================================================================
static int test_func(void)
{
    CMeMaterialProperty mtl;
    const int timerid = 0;
    const int N=100000;
    CThinshellBridsonElement shell;
    Vector3d p0(0, -1, 0);
    Vector3d p1(0, 1, 0);
    Vector3d p2(0,0,1);
    Vector3d p3(1, 0, 0);
    Vector3d F[4];
	Vector3d vbuffer[4]={p0, p1, p2, p3};
	const int NJ = 16;
	double3x3 jac[NJ];
    double3x3 *ppJacobian[NJ];
    double t=0.01;
    int quad[4]={0,1,2,3};
    shell.init(mtl, 0, quad, p0, p1, p2, p3, t);

	for (int i=0; i<NJ; i++) jac[i].ZeroMatrix(), ppJacobian[i]=&jac[i];

    startFastTimer(timerid);
    const int j=3;
    for (int i=0; i<N; i++){
		F[0]=F[1]=F[2]=F[3]=Vector3d(0);
        //const double k = 1.0*i/N;
        //double a = 180.0*k;
        //double t = PI*k;
        //double z = 1;
        //double x = 0;
        //p2 = Vector3d(x, 0, z);
		const int *vid = shell.getElementNodeBuffer();
		const int i0 = vid[0];
		const int i1 = vid[1];
		const int i2 = vid[2];
		const int i3 = vid[3];
		Vector3d &x0 = vbuffer[i0];
		Vector3d &x1 = vbuffer[i1];
		Vector3d &x2 = vbuffer[i2];
		Vector3d &x3 = vbuffer[i3];
        shell.computeForce(x0, x1, x2, x3, 0, mtl, F, ppJacobian);
        //printf("Angel %3lg, Force is %8lg %8lg %8lg\n", a, F[j].x, F[j].y, F[j].z);
    }
    stopFastTimer(timerid);
    reportTimeDifference(timerid, "Bridson Shell template elm run time:");

    return 1;
}

/*
void test_thinshellelm(void * pshell, 
	const Vector3d &p0, const Vector3d &p1, const Vector3d&p2, const Vector3d&p3, const Vector3d&p4, const Vector3d&p5
	)
{
	CMeMaterialProperty mtl;
	Vector3d pp0 = p0;
	Vector3d pp1 = p1;
	Vector3d pp2 = p2;
	Vector3d pp3 = p3;
	Vector3d pp4 = p4;
	Vector3d pp5 = p5;
	Vector3d ZERO(1e-30);
	CThinshellElement *tshell = (CThinshellElement *)pshell;
	//CThinshellElement shell = *tshell;
    double3x3 *ppJacobian[6]={NULL, NULL, NULL, NULL, NULL, NULL};
    Vector3d F[6];
    const int timerid = 0;
    const int N=1000000;
	const Vector3d *v=&p0;
	//printf("p0 %lg %lg %lg, ", v->x, v->y, v->z);
	v=&p1;
	//printf("p1 %lg %lg %lg, ", v->x, v->y, v->z);
	v=&p2;
	//printf("p2 %lg %lg %lg\n", v->x, v->y, v->z);
	v=&p3;
	//printf("p3 %lg %lg %lg, ", v->x, v->y, v->z);
	v=&p4;
	//printf("p4 %lg %lg %lg, ", v->x, v->y, v->z);
	v=&p5;
	//printf("p5 %lg %lg %lg\n", v->x, v->y, v->z);
    startFastTimer(timerid);
    for (int i=0; i<N; i++){
		pp0+=ZERO;
		//tshell->computeForceBridson(pp0, pp1, pp2, pp3, 0, mtl, F, ppJacobian);
		tshell->computeForce(pp0, pp1, pp2, pp3, pp4, pp5, 0, mtl, F, ppJacobian);
    }
    stopFastTimer(timerid);
    const double t = getTimeDifference(timerid);
	printf("Shell Template Element run time:%lg, Looping %d\n", t, N);
}

void computeForceNoTemp(void *shell, 
		const Vector3d &p0, const Vector3d &p1, const Vector3d&p2, const Vector3d&p3, const Vector3d&p4, const Vector3d&p5, 
		const int isstatic,
		CMeMaterialProperty&mtl, 
		Vector3d *force, 
		double3x3 *ppjac[6])
{
	CThinshellElement *tshell = (CThinshellElement *)shell;
	tshell->computeForce(p0, p1, p2, p3, p4, p5, isstatic, mtl, force, ppjac);
}
*/
//static int ntest = test_shellelmfunc();
//static int ntest = test_func();
